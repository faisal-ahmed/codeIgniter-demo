<?phpclass Codeigniter_user extends CI_Controller {    function __construct() {        parent::__construct();        define('ACCESS_KEY', 'c4bcc3f7c9bf9ec159f51da0a86ca658');        define('FORMAT', 'json');        define('CODEIGNITER_API_ARTICLE', 'http://api.newscred.com/articles');        define('CODEIGNITER_API_TOPIC', 'http://api.newscred.com/topics');    }    function index() {        $this->load->helper(array('form', 'url'));        $this->load->library('form_validation');        $this->load->model('user');        $data = array();        $this->form_validation->set_rules('username', 'Username', 'required');        $this->form_validation->set_rules('password', 'Password', 'required');        $username = $this->input->post('username');        $password = $this->input->post('password');        if ($this->form_validation->run() == FALSE) {            $this->load->view('header');            $this->load->view('login_content', $data);            $this->load->view('footer');        } else if ($this->user->password_req($username, $password) == FALSE) {            $this->session->set_userdata('msg', 'Incorrect username or password.');            $this->load->view('header');            $this->load->view('login_content', $data);            $this->load->view('footer');        } else {            $this->session->set_userdata('login', true);            $this->session->set_userdata('msg', 'Welcome');            redirect('codeigniter_user/welcome', 'refresh');            exit();        }    }    function password_cng() {        $login = $this->session->userdata('login');        if ($login != true) {            $this->session->set_userdata('msg', 'You are not logged in. Please login to continue.');            redirect('codeigniter_user', 'refresh');        }        $data = array();        $data['msg'] = "";        $this->load->helper(array('form', 'url'));        $this->load->library('form_validation');        $this->load->model('user');        $current_pass = $this->input->post('current_password');        $pass = $this->input->post('new_password');        $this->form_validation->set_rules('current_password', 'Current Password', 'required');        $this->form_validation->set_rules('new_password', 'New Password', 'required');        if ($this->form_validation->run() == FALSE) {            $this->loadview("password_cng_content", $data);            $this->session->set_userdata('msg', 'Field can not be blank.');        } else if ($this->user->check_password($current_pass) == FALSE) {            $this->loadview("password_cng_content", $data);            $this->session->set_userdata('msg', 'Current password does not match.');        } else {            $this->user->new_password($pass, $current_pass);            $this->session->set_userdata('msg', 'New passoword has been chosen successfully.');            redirect('codeigniter_user/welcome', 'refresh');        }    }    function welcome() {        $login = $this->session->userdata('login');        if ($login != true) {            $this->session->set_userdata('msg', 'You are not logged in. Please login to continue.');            redirect('codeigniter_user', 'refresh');        }        $data = array();        $this->load->helper(array('form', 'url'));        $this->load->model('user');        $this->loadview('welcome', $data);    }    function loadview($content_template, $data) {        $this->load->view("header");        $this->load->view("leftPanel");        $this->load->view($content_template, $data);        $this->load->view("footer");    }    function logout() {        $login = $this->session->userdata('login');        if ($login != true) {            redirect('codeigniter_user', 'refresh');        }        $this->session->sess_destroy();        redirect('codeigniter_user', 'refresh');    }    function get_data() {        $query = $this->input->post('query');        $url_article = CODEIGNITER_API_ARTICLE . "?access_key=" . ACCESS_KEY . "&format=" . FORMAT . "&q=" . $query;        $url_topic = CODEIGNITER_API_TOPIC . "?access_key=" . ACCESS_KEY . "&format=" . FORMAT . "&q=" . $query;        $data = array();        $data['article'] = json_decode(file_get_contents($url_article));        $data['topic'] = json_decode(file_get_contents($url_topic));        echo json_encode($data);        die;    }}?>